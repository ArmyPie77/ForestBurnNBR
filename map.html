<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quebec Burn Scar Explorer · Map</title>
  <link rel="stylesheet" href="css/styles.css" />
  <meta name="description" content="Visualize post-fire burn severity across Quebec using Landsat-derived delta NBR imagery.">
  <link rel="preconnect" href="https://unpkg.com">
</head>
<body>

  <a class="skip-link" href="#main">Skip to content</a>

  <header class="site-header">
    <div class="container">
      <h1 class="logo"><a href="index.html" aria-label="Home">Quebec Burn Scar Explorer</a></h1>
      <nav aria-label="Primary">
        <ul class="nav">
          <li><a href="index.html">Home</a></li>
          <li><a class="active" href="map.html">Map</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main id="main" class="container map-page">
    <section>

      <div class="map-layout">
        <div class="map-panel">
          <div id="map" class="map" role="application"
              aria-label="Interactive map of Quebec fire burn areas"></div>
          <div id="loadingOverlay" class="loading hidden">
            <div class="spinner"></div>
            <div class="loading-text">Loading…</div>
          </div>
        </div>

        <aside class="controls" aria-label="Map controls">
          <div class="controls-header">
            <h2 class="controls-title">Interactive Map</h2>
            <p class="controls-subtitle">
              View burn severity across Quebec. Toggle pre-generated tiles or run your own analysis.
            </p>
          </div>

          <h3>Layers</h3>
          <label class="control-item">
            <input type="checkbox" id="chkStrip">
            2022–2023 burn tiles
          </label>
          <label class="control-item">
            <input type="checkbox" id="chkAddons" checked>
            2022–2023 add-ons (new batch)
          </label>
          <label class="control-item">
            <input type="checkbox" id="chkTest">
            2017–2018 test tiles
          </label>
          <label class="control-item">
            <input type="checkbox" id="chkGrid" checked>
            Show WRS grid
          </label>

          <h3>Tile info</h3>
          <div id="tileInfo" class="info-box">
            <p>Click a yellow tile outline on the map to see its details.</p>
          </div>
          <div id="selectedList" class="info-box">
            <p><strong>Selected tiles:</strong> (none)</p>
          </div>

          <div class="info-box how-to">
            <p><strong>How to use:</strong></p>
            <p>1) Toggle seasons you want visible.</p>
            <p>2) Click tiles (shift-click for multiple) to fill path/row.</p>
            <p>3) Set dates and run analysis. It can be slow.</p>
          </div>

          <h3>Custom analysis (API)</h3>

          <div class="control-item">
            <label>
              Path
              <input type="number" id="apiPath" min="1" max="233" value="17">
            </label>
          </div>

          <div class="control-item">
            <label>
              Row
              <input type="number" id="apiRow" min="1" max="248" value="23">
            </label>
          </div>

          <div class="control-item">
            <label>
              Pre-fire start
              <input type="date" id="preStart" autocomplete="off">
            </label>
          </div>

          <div class="control-item">
            <label>
              Pre-fire end
              <input type="date" id="preEnd" autocomplete="off">
            </label>
          </div>

          <div class="control-item">
            <label>
              Post-fire start
              <input type="date" id="postStart" autocomplete="off">
            </label>
          </div>

          <div class="control-item">
            <label>
              Post-fire end
              <input type="date" id="postEnd" autocomplete="off">
            </label>
          </div>

          <button id="runApiBtn" class="button" type="button">Run analysis</button>

          <div id="apiResult" class="info-box muted" style="margin-top:0.7rem;">
            Results will appear here.
          </div>

          <!-- future UI:
          <label>Pre-fire start <input type="date" id="preStart"></label>
          <label>Pre-fire end <input type="date" id="preEnd"></label>
          <label>Post-fire start <input type="date" id="postStart"></label>
          <label>Post-fire end <input type="date" id="postEnd"></label>
          <button id="runApiBtn">Run analysis</button>
          -->
        </aside>
      </div>

      <details class="help">
        <summary>Troubleshooting</summary>
        <ul>
          <li>Open with a local server to avoid CORS: <code>python -m http.server</code></li>
          <li>Make sure PNG tiles are in the correct folder (see <code>js/map.js</code> config).</li>
          <li>Use your browser console (F12) to see errors.</li>
        </ul>
      </details>
    </section>

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
    <script src="https://unpkg.com/@turf/turf@6.5.0/turf.min.js"></script>

    <script src="js/map.js"></script>
  </main>


  <footer class="site-footer">
    <div class="container">
      <p>© 2025 Quebec Forest Fire MVP — Built with Leaflet. For GEOG 464.</p>
    </div>
  </footer>

</body>
</html>
